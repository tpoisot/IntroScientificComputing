<!doctype html><html><head><link rel=stylesheet href=https://use.fontawesome.com/releases/v5.6.1/css/all.css integrity=sha384-gfdkjb5BdAXd+lj+gudLWI+BXq4IuLW5IT+brZEZsLFm++aCMlF1V92rMkPaX4PP crossorigin=anonymous><link rel=stylesheet href=//cdn.jsdelivr.net/npm/hack-font@3.3.0/build/web/hack.css><script src=https://cdnjs.cloudflare.com/ajax/libs/mermaid/8.0.0/mermaid.js></script><link rel=stylesheet href=/css/normalize.css><link rel=stylesheet href=https://sciencecomputing.io/configuration.e1a586f12c5d659d35ded04f30bd11509694fd26671ab0bf05940315ca701bc9.css><link rel=stylesheet href=https://sciencecomputing.io/index.adfd3a1f1be564d6cd68f502c94cb524145e12ad379bb59bbcdf7ad62498ee36.css><meta charset=utf-8><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.10.0-rc.1/dist/katex.min.css integrity=sha384-D+9gmBxUQogRLqvARvNLmA9hS2x//eK1FhVb9PiU86gmcrBrJAQT8okdJ4LMp2uv crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.10.0-rc.1/dist/katex.min.js integrity=sha384-483A6DwYfKeDa0Q52fJmxFXkcPCFfnXMoXblOkJ4JcA8zATN6Tm78UNL72AKk+0O crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.10.0-rc.1/dist/contrib/auto-render.min.js integrity=sha384-yACMu8JWxKzSp/C1YV86pzGiQ/l1YUfE8oPuahJQxzehAjEt2GiQuy/BIvl9KyeF crossorigin=anonymous></script><script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:true},{left:"$",right:"$",display:false}]});});</script><title>Iteration and array navigation · Scientific computing</title></head><body><nav id=main class=sidebar><img src=/logo.png alt style=position:absolute;left:50%;width:56px;margin-left:-28px;margin-top:5px><div class=header><h1><a href=/>Scientific computing</a></h1><h2>(for the rest of us)</h2></div><ul class=nav><li class=lessons><i class="fas fa-fw fa-book-open"></i><a class="sidebar-nav-item active" href=/lessons/>Lessons</a></li><li class=primers><i class="fas fa-fw fa-bolt"></i><a class=sidebar-nav-item href=/primers/>Primers</a></li><li class=capstones><i class="fas fa-fw fa-star"></i><a class=sidebar-nav-item href=/capstones/>Capstones</a></li><li class=ml><i class="fas fa-fw fa-brain"></i><a class=sidebar-nav-item href=/machinelearning/>AI/ML</a></li></ul></nav><section id=content><section class=introduction><h2 id=introducing-iteration>Introducing iteration</h2><p>The <code>for</code> operation is one of the most common, but also one of the most
confusing, ways to tell a computer what to do. This is because it requires to
understand a lot of concepts at once; we will walk through each of them, get
confused a little bit, then get confused a lot, then get it.</p><p>When talking about <code>for</code>, we usually talk about <em>for loops</em> or <em>iteration</em>. This
is because <code>for</code> lets you express the fact that you will perform an operation on
a (finite) set of elements. Let&rsquo;s start with a perfectly boring yet somewhat
instructive example. We can draw five random numbers between 0 and 1, using</p><div class=highlight><pre class=chroma><code class=language-julia data-lang=julia><span class=n>rand</span><span class=p>(</span><span class=mi>5</span><span class=p>)</span>
</code></pre></div><p>We might want to print <em>smol</em> when a number is lower or equal to 0.5, and
<em>chonky</em> in the rest of the situations. In a lot of programming examples, you
will see <em>foo</em> and <em>bar</em>. Why on Earth would we need to print <em>foo</em> and <em>bar</em>?
These are nonsense words used as placeholders by programmers. Of course, what
with us being all fancy, the term you should use instead of nonsense is
&ldquo;metasyntactic variables&rdquo;. But polysyllabic nonsense is nonsense still, and so
we will use the far more dignified <em>smol</em> and <em>chonky</em>:</p><div class=highlight><pre class=chroma><code class=language-julia data-lang=julia><span class=n>random_numbers</span> <span class=o>=</span> <span class=n>rand</span><span class=p>(</span><span class=mi>5</span><span class=p>)</span>

<span class=k>for</span> <span class=n>random_number</span> <span class=kp>in</span> <span class=n>random_numbers</span>
  <span class=k>if</span> <span class=n>random_number</span> <span class=o>≤</span> <span class=mf>0.5</span>
    <span class=n>println</span><span class=p>(</span><span class=s>&#34;smol&#34;</span><span class=p>)</span>
  <span class=k>else</span>
    <span class=n>println</span><span class=p>(</span><span class=s>&#34;chonky&#34;</span><span class=p>)</span>
  <span class=k>end</span>
<span class=k>end</span>
</code></pre></div><pre><code>smol
smol
smol
chonky
chonky
</code></pre><p>There is quite a lot happening here, so we will go line by line.</p><div class=highlight><pre class=chroma><code class=language-julia data-lang=julia><span class=n>random_numbers</span> <span class=o>=</span> <span class=n>rand</span><span class=p>(</span><span class=mi>5</span><span class=p>)</span>
</code></pre></div><p>First, we generate 5 random numbers, and put them in a variable called
<code>random_numbers</code>. It is always a good idea to give very explicit names to
variables. To begin with, most code editors will be very good at autocompletion:
type a few letters, then hit the <em>Tab</em> key, and you will see the possible
values.</p><p>Giving plural names to things that have multiple elements is also useful: it
helps to have code that reads like plain english. By contrast, variables whose
name is singular have a single value in them.</p><p>Now we can start the loop itself:</p><pre><code class=language-raw data-lang=raw>for random_number in random_numbers
    # Content of the loop
end
</code></pre><p>This line gives a simple instruction to your computer. Actually, no. It gives a
bunch of complex instructions to your computer, but it is an easy enough
instruction for us to <em>write</em>, and this is all that matters.</p><p>It goes something like this:</p><ol><li>look at what is inside <code>random_numbers</code></li><li>take the first value, and name it <code>random_number</code></li><li>do whatever we tell you to do with this variable until you hit <code>end</code></li><li>move on to the next value of <code>random_numbers</code>, and start again</li><li>when you have exhausted the values in <code>random_numbers</code>, continue to whatever is <em>after</em> the end of the loop</li></ol><p>The <em>for</em> loop is one of the most difficult construct to understand, because of
this &ldquo;change the content of the variable&rdquo; trickery. We will have a few more
examples in this lesson.</p><p>The final lines we need to look at are in the <em>inside</em> of the loop &ndash; we call
this inside thing <em>the body</em> for no particular reason.</p><pre><code class=language-raw data-lang=raw>if random_number ≤ 0.5
    println(&quot;smol&quot;)
else
    println(&quot;chonky&quot;)
end
</code></pre><p>These lines should be familiar to you now &ndash; your computer will evaluate the
statement &ldquo;<code>random_number</code> is lower than or equal to 0.5&rdquo;, and depending on the
truthiness of it, will print either <em>foo</em> or <em>bar</em>.</p><div class=question id=isodd><h1><i class="fa fa-question-circle" aria-hidden=true></i>We don't get tired, we get even.</h1><div class=text><p>Let&rsquo;s practice with an exercice. We want to print all numbers between 1
and 12 that are <em>even</em>. Julia has an <code>iseven</code> function to do this, and we
will get you started with a block of code that is only missing a few
instruction &ndash; complete it to solve the problem!</p><pre><code>numbers = collect(1:12)

for ___ in numbers
    if ___
        println(___)
    end
end
</code></pre><button type=button onclick="document.getElementById('answer-isodd').classList.toggle('hidden');">See the answer</button></div><div class="answer hidden" id=answer-isodd><div class=highlight><pre class=chroma><code class=language-julia data-lang=julia><span class=n>numbers</span> <span class=o>=</span> <span class=n>collect</span><span class=p>(</span><span class=mi>1</span><span class=o>:</span><span class=mi>12</span><span class=p>)</span>

<span class=k>for</span> <span class=n>number</span> <span class=kp>in</span> <span class=n>numbers</span>
    <span class=k>if</span> <span class=n>iseven</span><span class=p>(</span><span class=n>number</span><span class=p>)</span>
        <span class=n>println</span><span class=p>(</span><span class=n>number</span><span class=p>)</span>
    <span class=k>end</span>
<span class=k>end</span>
</code></pre></div></div></div><h2 id=navigating-arrays>Navigating arrays</h2><p>Before we move on to a more interesting use of iteration, it is worth
understanding what exactly is in the <code>random_numbers</code> object. Let&rsquo;s display it
again:</p><div class=highlight><pre class=chroma><code class=language-julia data-lang=julia><span class=n>random_numbers</span>
</code></pre></div><pre><code>5-element Array{Float64,1}:
 0.21429206728717753
 0.2563389611749842
 0.1002934364096093
 0.6361009594715938
 0.6857995535757324
</code></pre><p>This type of object is an <em>array</em>; it may help to think of an array as a shelf,
in which every compartment can store one thing. You can have shelves with a
single row, a single column, or both rows and columns. In <em>Julia</em>, arrays are by
default columns, and this is important for applications like linear algebra
(they behave as vectors). Arrays have all sorts of properties, the most
important being their <em>length</em>:</p><div class=highlight><pre class=chroma><code class=language-julia data-lang=julia><span class=n>length</span><span class=p>(</span><span class=n>random_numbers</span><span class=p>)</span>
</code></pre></div><pre><code>5
</code></pre><p>This tells us that our &ldquo;shelf&rdquo; has five compartments, so we can store five
things in it. We can also ask what its <em>size</em> is:</p><div class=highlight><pre class=chroma><code class=language-julia data-lang=julia><span class=n>size</span><span class=p>(</span><span class=n>random_numbers</span><span class=p>)</span>
</code></pre></div><pre><code>(5,)
</code></pre><p>The output is <code>(5,)</code> - this is the computer way of telling us that this array
has 5 positions in its first <em>dimension</em>, and no positions in its second
dimension: this is a column with five rows. We can also access any <em>position</em> we
like; this is akin to asking &ldquo;computer, give me the content of the 1st
compartment&rdquo;:</p><div class=highlight><pre class=chroma><code class=language-julia data-lang=julia><span class=n>random_numbers</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span>
</code></pre></div><pre><code>0.21429206728717753
</code></pre><p>Some languages, like <em>Julia</em>, <em>R</em>, and <em>MatLab</em>, start counting from 1, but
<em>python</em> and <em>C</em> start counting from 0. These are conventions that each language
adopted. Everyone thinks the other camp is wrong, and it&rsquo;s one of these
surprisingly bitter (considering how utterly unimportant they are) divides in
the computer science world.</p><p>We can *also ask what the <em>last</em> position contains:</p><div class=highlight><pre class=chroma><code class=language-julia data-lang=julia><span class=n>random_numbers</span><span class=p>[</span><span class=n>length</span><span class=p>(</span><span class=n>random_numbers</span><span class=p>)]</span>
</code></pre></div><pre><code>0.6857995535757324
</code></pre><p>The way to read this instruction is as follows: get me the element at position
<code>length(random_numbers)</code>. We know that the length of <code>random_numbers</code> is <code>5</code>, so
this will return the 5th position. <em>Julia</em> has a quite pretty way of getting the
last element of most collections:</p><div class=highlight><pre class=chroma><code class=language-julia data-lang=julia><span class=n>random_numbers</span><span class=p>[</span><span class=k>end</span><span class=p>]</span>
</code></pre></div><pre><code>0.6857995535757324
</code></pre><p>An extra bit of <a href=https://en.wikipedia.org/wiki/Syntactic_sugar>syntactic sugar</a> in <em>Julia</em> are the two following
functions:</p><div class=highlight><pre class=chroma><code class=language-julia data-lang=julia><span class=n>first</span><span class=p>(</span><span class=n>random_numbers</span><span class=p>)</span>
</code></pre></div><pre><code>0.21429206728717753
</code></pre><div class=highlight><pre class=chroma><code class=language-julia data-lang=julia><span class=n>last</span><span class=p>(</span><span class=n>random_numbers</span><span class=p>)</span>
</code></pre></div><pre><code>0.6857995535757324
</code></pre><p>Being able to access elements by their position can be very useful. Our
<code>random_numbers</code> array has five elements, and we only want to print the
odd-numbered ones. One way to do this would be to call then individually:</p><div class=highlight><pre class=chroma><code class=language-julia data-lang=julia><span class=n>println</span><span class=p>(</span><span class=n>random_numbers</span><span class=p>[</span><span class=mi>1</span><span class=p>])</span>
<span class=n>println</span><span class=p>(</span><span class=n>random_numbers</span><span class=p>[</span><span class=mi>3</span><span class=p>])</span>
<span class=n>println</span><span class=p>(</span><span class=n>random_numbers</span><span class=p>[</span><span class=mi>5</span><span class=p>])</span>
</code></pre></div><pre><code>0.21429206728717753
0.1002934364096093
0.6857995535757324
</code></pre><p>Of course, this is only reasonable if we have a very small number of things to
do. But what if we want to iterate over hundreds, or thousands of values? We
need a more efficient strategy.</p><h2 id=iterating-over-values>Iterating over values</h2><p>We know that a number is even if the statement <code>x % 2 == 0</code>, where <code>%</code> is
integer division. We can also say that a number is even if the remainder of its
integer division by two is <em>not</em> 0: <code>x % 2 != 0</code>.</p><p>Let&rsquo;s go:</p><div class=highlight><pre class=chroma><code class=language-julia data-lang=julia><span class=k>for</span> <span class=n>i</span> <span class=kp>in</span> <span class=n>eachindex</span><span class=p>(</span><span class=n>random_numbers</span><span class=p>)</span>
  <span class=k>if</span> <span class=n>i</span> <span class=o>%</span> <span class=mi>2</span> <span class=o>!=</span> <span class=mi>0</span>
    <span class=n>println</span><span class=p>(</span><span class=s>&#34;Position </span><span class=si>$i</span><span class=s>:</span><span class=se>\t</span><span class=s>&#34;</span><span class=p>,</span> <span class=n>random_numbers</span><span class=p>[</span><span class=n>i</span><span class=p>])</span>
  <span class=k>end</span>
<span class=k>end</span>
</code></pre></div><pre><code>Position 1:	0.21429206728717753
Position 3:	0.1002934364096093
Position 5:	0.6857995535757324
</code></pre><p>We can &ldquo;read&rdquo; this snippet (a <em>snippet</em> is the affectionate name given to a
litle chunk of code; a <em>chunk</em> is a much uglier name for &ldquo;a piece&rdquo;) as</p><pre><code>there is a variable i
it will take every value between 1 and the length of the ranom_numbers array
for every value
look if it is odd
if it is, print the random number at this position
</code></pre><p>The <code>eachindex</code> function is a very powerful way to get, well, every position in
an array; it is the same thing as writing <code>for i in 1:length(random_numbers)</code>,
but in a more expressive way.</p><p>All <code>for</code> loops will share the following structure:</p><div class=highlight><pre class=chroma><code class=language-julia data-lang=julia><span class=k>for</span> <span class=n>element</span> <span class=kp>in</span> <span class=n>collection</span>
    <span class=c># this bit can be as complex as we like -- but not too complex!</span>
    <span class=n>do_things</span><span class=p>(</span><span class=n>element</span><span class=p>)</span>
<span class=k>end</span>
</code></pre></div><p>There is an important notion to mention: the <em>scope</em>. The scope is the parts of
your program in which a variable exists. Let&rsquo;s look at this hypothetical code:</p><div class=highlight><pre class=chroma><code class=language-julia data-lang=julia><span class=k>for</span> <span class=n>i</span> <span class=kp>in</span> <span class=mi>1</span><span class=o>:</span><span class=mi>3</span>
    <span class=n>println</span><span class=p>(</span><span class=n>i</span><span class=p>)</span>
<span class=k>end</span>
</code></pre></div><p>It will take the values 1, 2, and 3, and put them in the variable <code>i</code>, one at a
time. This is like writing</p><div class=highlight><pre class=chroma><code class=language-julia data-lang=julia><span class=n>i</span> <span class=o>=</span> <span class=mi>1</span>
<span class=n>i</span> <span class=o>=</span> <span class=mi>2</span>
<span class=n>i</span> <span class=o>=</span> <span class=mi>3</span>
</code></pre></div><p>Right? So let&rsquo;s try. What do you think will happen if you run the cell below?</p><div class=highlight><pre class=chroma><code class=language-julia data-lang=julia><span class=k>for</span> <span class=n>i</span> <span class=kp>in</span> <span class=mi>1</span><span class=o>:</span><span class=mi>3</span>
    <span class=n>println</span><span class=p>(</span><span class=n>i</span><span class=p>)</span>
<span class=k>end</span>

<span class=n>println</span><span class=p>(</span><span class=n>i</span><span class=p>)</span>
</code></pre></div><pre><code>1
2
3
Error: UndefVarError: i not defined
</code></pre><p>What happens is that the variable <code>i</code> only exists within the <code>for</code> loop! This
might seem problematic at first, but it is actually much cleaner: this avoid
polluting your workspace with a lot of variables that are not really relevant.</p><p>This is true for all variables created within a loop. In the following code, <code>a</code>
is not defined outside of the loop:</p><div class=highlight><pre class=chroma><code class=language-julia data-lang=julia><span class=k>for</span> <span class=n>i</span> <span class=kp>in</span> <span class=mi>1</span><span class=o>:</span><span class=mi>3</span>
    <span class=n>a</span> <span class=o>=</span> <span class=n>i</span>
<span class=k>end</span>
</code></pre></div><p>If you want a variable to be accessible <em>outside</em> a loop, you can simply create
it before <em>and</em> declare it as a <code>global</code> variable (this is not required within
functions, and this is the point where reading the section of the Julia manual
on scope will help you):</p><div class=highlight><pre class=chroma><code class=language-julia data-lang=julia><span class=n>a</span> <span class=o>=</span> <span class=mi>0</span>
<span class=k>for</span> <span class=n>i</span> <span class=kp>in</span> <span class=mi>1</span><span class=o>:</span><span class=mi>3</span>
    <span class=kd>global</span> <span class=n>a</span>
    <span class=n>a</span> <span class=o>=</span> <span class=n>i</span>
<span class=k>end</span>
<span class=n>println</span><span class=p>(</span><span class=n>a</span><span class=p>)</span>
</code></pre></div><pre><code>3
</code></pre><h2 id=doing-something-until-something-happens>Doing something until something happens</h2><p>Before moving on, there is an additional construct we can use: <code>while</code>. This one
is <em>dangerous</em> (or at the very least <em>possibly inconvenient</em>), because it will
keep on running <em>until</em> something happens. Why is not called <code>until</code>? Because
most programming languages have been designed with little regard for the way
humans think&mldr;</p><p>A good example of <code>while</code> in action is to keep on generating random numbers
<em>until</em> their mean is within a certain range of a desired value. The <code>rand()</code>
function will generate numbers uniformly distributed between 0 and 1, so we can
run it for a while (<em>GET IT?</em>) to get a sample with an average of about 0.5.</p><p>We can for example write it this way:</p><div class=highlight><pre class=chroma><code class=language-julia data-lang=julia><span class=k>using</span> <span class=n>Statistics</span> <span class=c># We need this to use mean</span>

<span class=n>my_collection</span> <span class=o>=</span> <span class=n>rand</span><span class=p>(</span><span class=mi>5</span><span class=p>)</span>

<span class=k>while</span> <span class=o>!</span><span class=p>(</span><span class=mf>0.499</span> <span class=o>≤</span> <span class=n>mean</span><span class=p>(</span><span class=n>my_collection</span><span class=p>)</span> <span class=o>≤</span> <span class=mf>0.501</span><span class=p>)</span>
  <span class=n>append!</span><span class=p>(</span><span class=n>my_collection</span><span class=p>,</span> <span class=n>rand</span><span class=p>(</span><span class=mi>5</span><span class=p>))</span>
<span class=k>end</span>

<span class=n>println</span><span class=p>(</span><span class=s>&#34;μ: </span><span class=si>$</span><span class=p>(</span><span class=n>round</span><span class=p>(</span><span class=n>mean</span><span class=p>(</span><span class=n>my_collection</span><span class=p>);</span> <span class=n>digits</span><span class=o>=</span><span class=mi>4</span><span class=p>))</span><span class=s>&#34;</span><span class=p>)</span>
</code></pre></div><pre><code>μ: 0.4996
</code></pre><p>The instruction just after <code>while</code>, <em>i.e.</em></p><pre><code>!(0.499 ≤ mean(my_collection) ≤ 0.501)
</code></pre><p>is worth thinking about. It is a very compact way of running multiple tests at
once: the mean needs to be larger than 0.499, yet smaller than 0.501, and we
need to continue <em>until</em> this is true (but there is not <em>until</em> statement, so we
use the awkward &ldquo;while not&rdquo;).</p><div class="callout danger">If we are particularly unlucky, we would never get a sequence of random numbers
that would match this condition! In this case, our computer would stubbornly
keep running until the heat death of the universe (or until it breaks, which in
all likelihood will happen earlier). Writing <code>while</code> loops can be a complex
exercice, and it is always good to think about &ldquo;exit strategies&rdquo;. These will be
discussed in the <a href=https://sciencecomputing.io/primers/advanced_control_flow/>&ldquo;Advanced control flow&rdquo;</a> primer.</div><p>This concludes the lesson on the flow of execution. These concepts are very
important to understand in depth, as everything else we do is built on them. Now
would be a good time to get back to the questions, or to try and change the
examples, to make sure you are familiar with the material.</p><div class=question id=extrema><h1><i class="fa fa-question-circle" aria-hidden=true></i>Generating a diverse enough sample of numbers.</h1><div class=text><p>For this question, we want to take the k first numbers from a series
of random numbers, so that the difference between the largest and the
smallest is <em>at least</em> some arbitrary threshold. By looking at the
documentation for the <code>extrema</code> function, and by remembering what the
<code>first</code> and <code>last</code> functions do, complete the following code:</p><pre><code>numbers = rand(10000);
threshold = 0.5

for k in ___(numbers)
    series = ___[1:k]
    extremas = ___(___)
    if (___(___) - ___(___)) ≥ threshold
        println(___)
        break
    end
end
</code></pre><p>The <code>break</code> keyword is here to stop our loop when we have found the
correct value of k.</p><button type=button onclick="document.getElementById('answer-extrema').classList.toggle('hidden');">See the answer</button></div><div class="answer hidden" id=answer-extrema><div class=highlight><pre class=chroma><code class=language-julia data-lang=julia><span class=n>numbers</span> <span class=o>=</span> <span class=n>rand</span><span class=p>(</span><span class=mi>10000</span><span class=p>);</span>
<span class=n>threshold</span> <span class=o>=</span> <span class=mf>0.5</span>

<span class=k>for</span> <span class=n>k</span> <span class=kp>in</span> <span class=n>eachindex</span><span class=p>(</span><span class=n>numbers</span><span class=p>)</span>
    <span class=n>series</span> <span class=o>=</span> <span class=n>numbers</span><span class=p>[</span><span class=mi>1</span><span class=o>:</span><span class=n>k</span><span class=p>]</span>
    <span class=n>extremas</span> <span class=o>=</span> <span class=n>extrema</span><span class=p>(</span><span class=n>series</span><span class=p>)</span>
    <span class=k>if</span> <span class=p>(</span><span class=n>last</span><span class=p>(</span><span class=n>extremas</span><span class=p>)</span> <span class=o>-</span> <span class=n>first</span><span class=p>(</span><span class=n>extremas</span><span class=p>))</span> <span class=o>≥</span> <span class=n>threshold</span>
        <span class=n>println</span><span class=p>(</span><span class=n>k</span><span class=p>)</span>
        <span class=k>break</span>
    <span class=k>end</span>
<span class=k>end</span>
</code></pre></div></div></div></section></section><script>mermaid.initialize({startOnLoad:true,theme:"neutral",curve:"basis"});</script></body></html>